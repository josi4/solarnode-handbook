
<!DOCTYPE html>

<html class="no-js" lang="en">
<head>
<meta charset="utf-8"/>
<meta content="width=device-width,initial-scale=1" name="viewport"/>
<link href="https://solarnetwork.github.io/solarnode-handbook/users/datum-filters/tariff/" rel="canonical"/>
<link href="../split/" rel="prev"/>
<link href="../throttle/" rel="next"/>
<link href="../../../assets/images/favicon.png" rel="icon"/>
<meta content="mkdocs-1.4.2, mkdocs-material-9.1.7" name="generator"/>
<title>Tariff - SolarNode Handbook</title>
<link href="../../../assets/stylesheets/main.ded33207.min.css" rel="stylesheet"/>
<link href="../../../assets/stylesheets/palette.a0c5b2b5.min.css" rel="stylesheet"/>
<link crossorigin="" href="https://fonts.gstatic.com" rel="preconnect"/>
<link href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&amp;display=fallback" rel="stylesheet"/>
<style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
<link href="../../../css/sn.css" rel="stylesheet"/>
<script>__md_scope=new URL("../../..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
</head>
<body data-md-color-accent="indigo" data-md-color-primary="amber" data-md-color-scheme="default" dir="ltr">
<script>var palette=__md_get("__palette");if(palette&&"object"==typeof palette.color)for(var key of Object.keys(palette.color))document.body.setAttribute("data-md-color-"+key,palette.color[key])</script>
<input autocomplete="off" class="md-toggle" data-md-toggle="drawer" id="__drawer" type="checkbox"/>
<input autocomplete="off" class="md-toggle" data-md-toggle="search" id="__search" type="checkbox"/>
<label class="md-overlay" for="__drawer"></label>
<div data-md-component="skip">
<a class="md-skip" href="#time-based-tariff-datum-filter">
          Skip to content
        </a>
</div>
<div data-md-component="announce">
</div>
<header class="md-header md-header--shadow" data-md-component="header">
<nav aria-label="Header" class="md-header__inner md-grid">
<a aria-label="SolarNode Handbook" class="md-header__button md-logo" data-md-component="logo" href="../../.." title="SolarNode Handbook">
<img alt="logo" src="../../../images/solarnode-icon.svg"/>
</a>
<label class="md-header__button md-icon" for="__drawer">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"></path></svg>
</label>
<div class="md-header__title" data-md-component="header-title">
<div class="md-header__ellipsis">
<div class="md-header__topic">
<span class="md-ellipsis">
            SolarNode Handbook
          </span>
</div>
<div class="md-header__topic" data-md-component="header-topic">
<span class="md-ellipsis">
            
              Tariff
            
          </span>
</div>
</div>
</div>
<form class="md-header__option" data-md-component="palette">
<input aria-label="Switch to dark mode" class="md-option" data-md-color-accent="indigo" data-md-color-media="(prefers-color-scheme: light)" data-md-color-primary="amber" data-md-color-scheme="default" id="__palette_1" name="__palette" type="radio"/>
<label class="md-header__button md-icon" for="__palette_2" hidden="" title="Switch to dark mode">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M12 8a4 4 0 0 0-4 4 4 4 0 0 0 4 4 4 4 0 0 0 4-4 4 4 0 0 0-4-4m0 10a6 6 0 0 1-6-6 6 6 0 0 1 6-6 6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12 20 8.69Z"></path></svg>
</label>
<input aria-label="Switch to light mode" class="md-option" data-md-color-accent="indigo" data-md-color-media="(prefers-color-scheme: dark)" data-md-color-primary="amber" data-md-color-scheme="slate" id="__palette_2" name="__palette" type="radio"/>
<label class="md-header__button md-icon" for="__palette_1" hidden="" title="Switch to light mode">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M12 18c-.89 0-1.74-.2-2.5-.55C11.56 16.5 13 14.42 13 12c0-2.42-1.44-4.5-3.5-5.45C10.26 6.2 11.11 6 12 6a6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12 20 8.69Z"></path></svg>
</label>
</form>
<label class="md-header__button md-icon" for="__search">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"></path></svg>
</label>
<div class="md-search" data-md-component="search" role="dialog">
<label class="md-search__overlay" for="__search"></label>
<div class="md-search__inner" role="search">
<form class="md-search__form" name="search">
<input aria-label="Search" autocapitalize="off" autocomplete="off" autocorrect="off" class="md-search__input" data-md-component="search-query" name="query" placeholder="Search" required="" spellcheck="false" type="text"/>
<label class="md-search__icon md-icon" for="__search">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"></path></svg>
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"></path></svg>
</label>
<nav aria-label="Search" class="md-search__options">
<button aria-label="Clear" class="md-search__icon md-icon" tabindex="-1" title="Clear" type="reset">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"></path></svg>
</button>
</nav>
</form>
<div class="md-search__output">
<div class="md-search__scrollwrap" data-md-scrollfix="">
<div class="md-search-result" data-md-component="search-result">
<div class="md-search-result__meta">
            Initializing search
          </div>
<ol class="md-search-result__list" role="presentation"></ol>
</div>
</div>
</div>
</div>
</div>
</nav>
</header>
<div class="md-container" data-md-component="container">
<main class="md-main" data-md-component="main">
<div class="md-main__inner md-grid">
<div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation">
<div class="md-sidebar__scrollwrap">
<div class="md-sidebar__inner">
<nav aria-label="Navigation" class="md-nav md-nav--primary" data-md-level="0">
<label class="md-nav__title" for="__drawer">
<a aria-label="SolarNode Handbook" class="md-nav__button md-logo" data-md-component="logo" href="../../.." title="SolarNode Handbook">
<img alt="logo" src="../../../images/solarnode-icon.svg"/>
</a>
    SolarNode Handbook
  </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item md-nav__item--active md-nav__item--nested">
<input checked="" class="md-nav__toggle md-toggle" id="__nav_1" type="checkbox"/>
<div class="md-nav__link md-nav__link--index">
<a href="../../">User Guide</a>
<label for="__nav_1">
<span class="md-nav__icon md-icon"></span>
</label>
</div>
<nav aria-expanded="true" aria-labelledby="__nav_1_label" class="md-nav" data-md-level="1">
<label class="md-nav__title" for="__nav_1">
<span class="md-nav__icon md-icon"></span>
          User Guide
        </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../getting-started/">
        Getting Started
      </a>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle" id="__nav_1_3" type="checkbox"/>
<div class="md-nav__link md-nav__link--index">
<a href="../../setup-app/">Setup App</a>
<label for="__nav_1_3">
<span class="md-nav__icon md-icon"></span>
</label>
</div>
<nav aria-expanded="false" aria-labelledby="__nav_1_3_label" class="md-nav" data-md-level="2">
<label class="md-nav__title" for="__nav_1_3">
<span class="md-nav__icon md-icon"></span>
          Setup App
        </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../setup-app/login/">
        Login
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../setup-app/home/">
        Home
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../setup-app/certificates/">
        Certificates
      </a>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle" id="__nav_1_3_5" type="checkbox"/>
<div class="md-nav__link md-nav__link--index">
<a href="../../setup-app/settings/">Settings</a>
<label for="__nav_1_3_5">
<span class="md-nav__icon md-icon"></span>
</label>
</div>
<nav aria-expanded="false" aria-labelledby="__nav_1_3_5_label" class="md-nav" data-md-level="3">
<label class="md-nav__title" for="__nav_1_3_5">
<span class="md-nav__icon md-icon"></span>
          Settings
        </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../setup-app/settings/manage-component/">
        Manage Component
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../setup-app/settings/datum-filters/">
        Datum Filters
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../setup-app/settings/logging/">
        Logging
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../setup-app/settings/op-modes/">
        Operational Modes
      </a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle" id="__nav_1_3_6" type="checkbox"/>
<div class="md-nav__link md-nav__link--index">
<a href="../../setup-app/tools/">Tools</a>
<label for="__nav_1_3_6">
<span class="md-nav__icon md-icon"></span>
</label>
</div>
<nav aria-expanded="false" aria-labelledby="__nav_1_3_6_label" class="md-nav" data-md-level="3">
<label class="md-nav__title" for="__nav_1_3_6">
<span class="md-nav__icon md-icon"></span>
          Tools
        </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../setup-app/tools/controls/">
        Controls
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../setup-app/tools/command-console/">
        Command Console
      </a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../setup-app/plugins/">
        Plugins
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../setup-app/profile/">
        Profile
      </a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../datum/">
        Datum
      </a>
</li>
<li class="md-nav__item md-nav__item--active md-nav__item--nested">
<input checked="" class="md-nav__toggle md-toggle" id="__nav_1_5" type="checkbox"/>
<div class="md-nav__link md-nav__link--index">
<a href="../">Datum Filters</a>
<label for="__nav_1_5">
<span class="md-nav__icon md-icon"></span>
</label>
</div>
<nav aria-expanded="true" aria-labelledby="__nav_1_5_label" class="md-nav" data-md-level="2">
<label class="md-nav__title" for="__nav_1_5">
<span class="md-nav__icon md-icon"></span>
          Datum Filters
        </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../chain/">
        Filter Chain
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../control-updater/">
        Control Updater
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../downsample/">
        Downsample
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../expression/">
        Expression
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../join/">
        Join
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../op-mode/">
        Operational Mode
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../parameter-expression/">
        Parameter Expression
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../property/">
        Property
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../split/">
        Split
      </a>
</li>
<li class="md-nav__item md-nav__item--active">
<input class="md-nav__toggle md-toggle" id="__toc" type="checkbox"/>
<label class="md-nav__link md-nav__link--active" for="__toc">
          Tariff
          <span class="md-nav__icon md-icon"></span>
</label>
<a class="md-nav__link md-nav__link--active" href="./">
        Tariff
      </a>
<nav aria-label="Table of contents" class="md-nav md-nav--secondary">
<label class="md-nav__title" for="__toc">
<span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
<ul class="md-nav__list" data-md-component="toc" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="#settings">
    Settings
  </a>
<nav aria-label="Settings" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#settings-notes">
    Settings notes
  </a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#metadata-service">
    Metadata Service
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#tariff-schedule-format">
    Tariff schedule format
  </a>
<nav aria-label="Tariff schedule format" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#example-schedule">
    Example schedule
  </a>
</li>
</ul>
</nav>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../throttle/">
        Throttle
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../unchanged-property/">
        Unchanged Property
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../unchanged/">
        Unchanged
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../virtual-meter/">
        Virtual Meter
      </a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../solarflux/">
        SolarFlux
      </a>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle" id="__nav_1_7" type="checkbox"/>
<div class="md-nav__link md-nav__link--index">
<a href="../../sysadmin/">System Administration</a>
<label for="__nav_1_7">
<span class="md-nav__icon md-icon"></span>
</label>
</div>
<nav aria-expanded="false" aria-labelledby="__nav_1_7_label" class="md-nav" data-md-level="2">
<label class="md-nav__title" for="__nav_1_7">
<span class="md-nav__icon md-icon"></span>
          System Administration
        </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../sysadmin/date-time/">
        Date and Time
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../sysadmin/networking/">
        Networking
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../sysadmin/packages/">
        Package Maintenance
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../sysadmin/solarnode-service/">
        SolarNode Service
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../sysadmin/solarssh/">
        SolarSSH
      </a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../networking/">
        Networking
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../security-tokens/">
        Security Tokens
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../remote-access/">
        Remote Access
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../expressions/">
        Expressions
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../placeholders/">
        Placeholders
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../configuration/">
        Configuration
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../settings/">
        Settings Files
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../logging/">
        Logging
      </a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle" id="__nav_2" type="checkbox"/>
<div class="md-nav__link md-nav__link--index">
<a href="../../../developers/">Developer Guide</a>
<label for="__nav_2">
<span class="md-nav__icon md-icon"></span>
</label>
</div>
<nav aria-expanded="false" aria-labelledby="__nav_2_label" class="md-nav" data-md-level="1">
<label class="md-nav__title" for="__nav_2">
<span class="md-nav__icon md-icon"></span>
          Developer Guide
        </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle" id="__nav_2_2" type="checkbox"/>
<div class="md-nav__link md-nav__link--index">
<a href="../../../developers/osgi/">Plugins</a>
<label for="__nav_2_2">
<span class="md-nav__icon md-icon"></span>
</label>
</div>
<nav aria-expanded="false" aria-labelledby="__nav_2_2_label" class="md-nav" data-md-level="2">
<label class="md-nav__title" for="__nav_2_2">
<span class="md-nav__icon md-icon"></span>
          Plugins
        </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../../developers/osgi/manifest/">
        Manifest
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../developers/osgi/life-cycle/">
        Life cycle
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../developers/osgi/configuration-admin/">
        Configuration Admin
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../developers/osgi/blueprint/">
        Blueprint
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../developers/osgi/blueprint-compendium/">
        Blueprint Compendium
      </a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle" id="__nav_2_3" type="checkbox"/>
<div class="md-nav__link md-nav__link--index">
<a href="../../../developers/settings/">Settings</a>
<label for="__nav_2_3">
<span class="md-nav__icon md-icon"></span>
</label>
</div>
<nav aria-expanded="false" aria-labelledby="__nav_2_3_label" class="md-nav" data-md-level="2">
<label class="md-nav__title" for="__nav_2_3">
<span class="md-nav__icon md-icon"></span>
          Settings
        </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../../developers/settings/provider/">
        Settings Provider
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../developers/settings/specifier/">
        Setting Specifier
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../developers/settings/resource-handler/">
        Setting Resource Handler
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../developers/settings/singleton/">
        Singleton Service
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../developers/settings/factory/">
        Factory Service
      </a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle" id="__nav_2_4" type="checkbox"/>
<label class="md-nav__link" for="__nav_2_4" id="__nav_2_4_label" tabindex="0">
          Services
          <span class="md-nav__icon md-icon"></span>
</label>
<nav aria-expanded="false" aria-labelledby="__nav_2_4_label" class="md-nav" data-md-level="2">
<label class="md-nav__title" for="__nav_2_4">
<span class="md-nav__icon md-icon"></span>
          Services
        </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../../developers/services/backup-manager/">
        Backup Manager
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../developers/services/closeable-service/">
        Closeable Service
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../developers/services/datum-data-source-poll-job/">
        Datum Data Source Poll Job
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../developers/services/datum-data-source/">
        Datum Data Source
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../developers/services/datum-db/">
        Datum Database
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../developers/services/datum-queue/">
        Datum Queue
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../developers/services/job-scheduler/">
        Job Scheduler
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../developers/services/placeholder-service/">
        Placeholder Service
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../developers/services/settings-db/">
        Settings Database
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../developers/services/settings-service/">
        Settings Service
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../developers/services/sql-database/">
        SQL Database
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../developers/services/task-executor/">
        Task Executor
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../developers/services/task-scheduler/">
        Task Scheduler
      </a>
</li>
</ul>
</nav>
</li>
</ul>
</nav>
</li>
</ul>
</nav>
</div>
</div>
</div>
<div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc">
<div class="md-sidebar__scrollwrap">
<div class="md-sidebar__inner">
<nav aria-label="Table of contents" class="md-nav md-nav--secondary">
<label class="md-nav__title" for="__toc">
<span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
<ul class="md-nav__list" data-md-component="toc" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="#settings">
    Settings
  </a>
<nav aria-label="Settings" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#settings-notes">
    Settings notes
  </a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#metadata-service">
    Metadata Service
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#tariff-schedule-format">
    Tariff schedule format
  </a>
<nav aria-label="Tariff schedule format" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#example-schedule">
    Example schedule
  </a>
</li>
</ul>
</nav>
</li>
</ul>
</nav>
</div>
</div>
</div>
<div class="md-content" data-md-component="content">
<article class="md-content__inner md-typeset">
<h1 id="time-based-tariff-datum-filter"><span class="enumerate-headings-plugin enumerate-heading-plugin">28.</span> Time-based Tariff Datum Filter<a class="headerlink" href="#time-based-tariff-datum-filter" title="Permanent link">¶</a></h1>
<p>The <a href="https://github.com/SolarNetwork/solarnetwork-node/blob/develop/net.solarnetwork.node.datum.filter.filter/README.md">Tariff Datum Filter</a> provides a way to inject time-based tariff rates based on a flexible
tariff schedule defined with various time constraints.</p>
<p>This filter is provided by the <a href="https://github.com/SolarNetwork/solarnetwork-node/blob/develop/net.solarnetwork.node.datum.filter.tariff/">Tariff Filter</a> plugin.</p>
<h2 id="settings"><span class="enumerate-headings-plugin enumerate-heading-plugin">28.1</span> Settings<a class="headerlink" href="#settings" title="Permanent link">¶</a></h2>
<figure>
<p><img alt="Tariff filter component settings" loading="lazy" src="../../../images/users/datum-filters/tariff-filter-settings%402x.png" width="742"/></p>
</figure>
<p>Each filter configuration contains the following overall settings:</p>
<table>
<thead>
<tr>
<th align="left">Setting</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left">Service Name</td>
<td align="left">A unique ID for the filter, to be referenced by other components.</td>
</tr>
<tr>
<td align="left">Service Group</td>
<td align="left">An optional service group name to assign.</td>
</tr>
<tr>
<td align="left">Source ID</td>
<td align="left">A regular expression <a href="https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/util/regex/Pattern.html">pattern</a> to match the input source ID(s) to filter.</td>
</tr>
<tr>
<td align="left">Required Mode</td>
<td align="left">If configured, an <a href="../../op-modes/">operational mode</a> that must be active for this filter to be applied.</td>
</tr>
<tr>
<td align="left">Required Tag</td>
<td align="left">Only apply the filter on datum with the given tag. A tag may be prefixed with <code>!</code> to invert the logic so that the filter only applies to datum <strong>without</strong> the given tag. Multiple tags can be defined using a <code>,</code> delimiter, in which case <strong>at least one</strong> of the configured tags must match to apply the filter.</td>
</tr>
<tr>
<td align="left">Metadata Service</td>
<td align="left">The <strong>Service Name</strong> of the Metadata Service to obtain the tariff schedule from. See <a href="#metadata-service">below</a> for more information.</td>
</tr>
<tr>
<td align="left">Metadata Path</td>
<td align="left">The metadata path that will resolve the tariff schedule from the configured Metadata Service.</td>
</tr>
<tr>
<td align="left">Language</td>
<td align="left">An IETF BCP 47 language tag to parse the tariff data with. If not configured then the default system language will be assumed.</td>
</tr>
<tr>
<td align="left">First Match</td>
<td align="left">If enabled, then apply only the <strong>first</strong> tariff that matches a given datum date. If disabled, then apply <strong>all</strong> tariffs that match.</td>
</tr>
<tr>
<td align="left">Schedule Cache</td>
<td align="left">The amount of seconds to cache the tariff schedule obtained from the configured Metadata Service.</td>
</tr>
<tr>
<td align="left">Tariff Evaluator</td>
<td align="left">The <strong>Service Name</strong> of a <em>Time-based Tariff Evaluator</em> service to evaluate each tariff to determine if it should apply to a given datum.</td>
</tr>
</tbody>
</table>
<h3 id="settings-notes"><span class="enumerate-headings-plugin enumerate-heading-plugin">28.1.1</span> Settings notes<a class="headerlink" href="#settings-notes" title="Permanent link">¶</a></h3>
<ul>
<li><strong>Source ID</strong> — This is a case-insensitive <a href="https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/util/regex/Pattern.html">regular expression</a> to match against
   datum source ID values. If omitted then datum for <em>all</em> source ID values will be filtered,
   otherwise only datum with <em>matching</em> source ID values will be filtered.</li>
<li><strong>Tariff Evaluator</strong> — If not configured a default algorithm is used that matches all non-empty
    constraints in an inclusive manner, except for the time-of-day constraint which uses an
    exclusive upper bound.</li>
</ul>
<h2 id="metadata-service"><span class="enumerate-headings-plugin enumerate-heading-plugin">28.2</span> Metadata Service<a class="headerlink" href="#metadata-service" title="Permanent link">¶</a></h2>
<p>SolarNode provides a <a href="../../user-metadata-service/">User Metadata Service</a> component that this filter
can use for the Metadata Service setting. This allows you to configure the tariff schedule as user
metadata in SolarNetwork and then SolarNode will download the schedule and use it as needed.</p>
<figure>
<p><img alt="User Metadata Service settings" loading="lazy" src="../../../images/users/user-metadata-settings%402x.png" width="697"/></p>
</figure>
<p>You must configure a SolarNetwork security token to use the User Metadata Service. We recommend that
you create a <strong>Data</strong> security token in SolarNetwork with a limited security policy that includes an
<strong>API Path</strong> of just <code>/users/meta</code> and a <strong>User Metadata Path</strong> of something granular like
<code>/pm/tariffs/**</code>. This will give SolarNode access to just the tariff metadata under the
<code>/pm/tariffs</code> metadata path.</p>
<figure>
<p><img alt="Tariff metadata security token" loading="lazy" src="../../../images/users/datum-filters/tariff-metadata-security-token%402x.png" width="697"/></p>
</figure>
<p>The <a href="https://go.solarnetwork.net/dev/api/">SolarNetwork API Explorer</a> can be used to add the necessary tariff schedule
metadata to your account. For example:</p>
<figure>
<p><img alt="API Explorer add tariff metadata" loading="lazy" src="../../../images/users/datum-filters/tariff-api-explorer-add-user-metdata%402x.png" width="678"/></p>
</figure>
<h2 id="tariff-schedule-format"><span class="enumerate-headings-plugin enumerate-heading-plugin">28.3</span> Tariff schedule format<a class="headerlink" href="#tariff-schedule-format" title="Permanent link">¶</a></h2>
<p>The tariff schedule obtained from the configured Metadata Service uses a simple CSV-based format
that can be easily exported from a spreadsheet. Each row represents a rule that includes:</p>
<ul>
<li>a set of time constraints that must be satisfied for the rule to be applied</li>
<li>a list of tariff rates to be added to datum when the constraints are satisfied</li>
</ul>
<div class="admonition tip">
<p class="admonition-title">Include a header row</p>
<p>A header row is <strong>required</strong> because the tariff rate names are defined there.
The first 4 column names are ignored.</p>
</div>
<p>The schedule consists of 4 time constraint columns followed by one or more tariff rate columns. Each
constraint is represented as a range, in the form <code>start - end</code>. Whitespace is allowed around the
<code>-</code> character. If the <code>start</code> and <code>end</code> are the same, the range may be shortened to just <code>start</code>. A
range can be left empty to represent <strong>all values</strong>. The time constraint columns are:</p>
<table>
<thead>
<tr>
<th align="left">Column</th>
<th align="left">Constraint</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left">1</td>
<td align="left">Month range</td>
<td align="left">An inclusive month range. Months can be specified as numbers (1-12) or abbreviations (Jan-Dec) or full names (January - December). When using text names case does not matter and they will be parsed using the <strong>Lanauage</strong> setting.</td>
</tr>
<tr>
<td align="left">2</td>
<td align="left">Day range</td>
<td align="left">An inclusive day-of-month range. Days are specified as numbers (1-31).</td>
</tr>
<tr>
<td align="left">3</td>
<td align="left">Weekday range</td>
<td align="left">An inclusive day-of-week range. Weekdays can be specified as numbers (1-7) with Monday being <code>1</code> and Sunday being <code>7</code>, or abbreviations (Mon-Sun) or full names (Monday - Sunday). When using text names case does not matter and they will be parsed using the <strong>Lanauage</strong> setting.</td>
</tr>
<tr>
<td align="left">4</td>
<td align="left">Time range</td>
<td align="left">An <strong>inclusive - exclusive</strong> time-of-day range. The time can be specified as whole hour numbers (0-24) or <code>HH:MM</code> style (<code>00:00</code> - <code>24:00</code>).</td>
</tr>
</tbody>
</table>
<p>Starting on column 5 of the tariff schedule are arbitrary rate values to add to datum when the
corresponding constraints are satisfied. The name of the datum property is derived from the <strong>header
row</strong> of the column, adapted according to the following rules:</p>
<ol>
<li>change to lower case</li>
<li>replacing any runs of non-alphanumeric or underscore with a single underscore</li>
<li>removing any leading/trailing underscores</li>
</ol>
<p>Here are some examples of the header name to the equivalent property name:</p>
<table>
<thead>
<tr>
<th align="left">Rate Header Name</th>
<th align="left">Datum Property Name</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left">TOU</td>
<td align="left"><code>tou</code></td>
</tr>
<tr>
<td align="left">Foo Bar</td>
<td align="left"><code>foo_bar</code></td>
</tr>
<tr>
<td align="left">This Isn't A Great Name!</td>
<td align="left"><code>this_isn_t_a_great_name</code></td>
</tr>
</tbody>
</table>
<h3 id="example-schedule"><span class="enumerate-headings-plugin enumerate-heading-plugin">28.3.1</span> Example schedule<a class="headerlink" href="#example-schedule" title="Permanent link">¶</a></h3>
<p>Here's an example schedule with 4 rules and a single <strong>TOU</strong> rate (the <code>*</code> stands for <strong>all values</strong>):</p>
<table>
<thead>
<tr>
<th align="left">Rule</th>
<th align="left">Month</th>
<th align="left">Day</th>
<th align="left">Weekday</th>
<th align="left">Time</th>
<th align="right">TOU</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left"><strong>1</strong></td>
<td align="left">Jan-Dec</td>
<td align="left">*</td>
<td align="left">Mon-Fri</td>
<td align="left">0-8</td>
<td align="right">10.48</td>
</tr>
<tr>
<td align="left"><strong>2</strong></td>
<td align="left">Jan-Dec</td>
<td align="left">*</td>
<td align="left">Mon-Fri</td>
<td align="left">8-24</td>
<td align="right">11.00</td>
</tr>
<tr>
<td align="left"><strong>3</strong></td>
<td align="left">Jan-Dec</td>
<td align="left">*</td>
<td align="left">Sat-Sun</td>
<td align="left">0-8</td>
<td align="right">9.19</td>
</tr>
<tr>
<td align="left"><strong>4</strong></td>
<td align="left">Jan-Dec</td>
<td align="left">*</td>
<td align="left">Sat-Sun</td>
<td align="left">8-24</td>
<td align="right">11.21</td>
</tr>
</tbody>
</table>
<p>In CSV format the schedule would look like this:</p>
<div class="highlight"><pre><span></span><code>Month,Day,Weekday,Time,TOU
Jan-Dec,,Mon-Fri,0-8,10.48
Jan-Dec,,Mon-Fri,8-24,11.00
Jan-Dec,,Sat-Sun,0-8,9.19
Jan-Dec,,Sat-Sun,8-24,11.21
</code></pre></div>
<p>When encoding into SolarNetwork metadata JSON, that same schedule would look like this when saved
at the <code>/pm/tariffs/schedule</code> path:</p>
<div class="highlight"><pre><span></span><code><span class="p">{</span>
<span class="w">  </span><span class="nt">"pm"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nt">"tariffs"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="nt">"schedule"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Month,Day,Weekday,Time,TOU\nJan-Dec,,Mon-Fri,0-8,10.48\nJan-Dec,,Mon-Fri,8-24,11.00\nJan-Dec,,Sat-Sun,0-8,9.19\nJan-Dec,,Sat-Sun,8-24,11.21"</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">  </span><span class="p">}</span>
<span class="p">}</span>
</code></pre></div>
</article>
</div>
</div>
</main>
<footer class="md-footer">
<div class="md-footer-meta md-typeset">
<div class="md-footer-meta__inner md-grid">
<div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" rel="noopener" target="_blank">
      Material for MkDocs
    </a>
</div>
</div>
</div>
</footer>
</div>
<div class="md-dialog" data-md-component="dialog">
<div class="md-dialog__inner md-typeset"></div>
</div>
<script id="__config" type="application/json">{"base": "../../..", "features": ["content.code.annotate", "content.code.copy", "navigation.indexes", "navigation.instant", "navigation.path", "navigation.tracking", "toc.follow"], "search": "../../../assets/javascripts/workers/search.208ed371.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
<script src="../../../assets/javascripts/bundle.51198bba.min.js"></script>
<script src="../../../js/open_in_new_tab.js"></script>
</body>
</html>